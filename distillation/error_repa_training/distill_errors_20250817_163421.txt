/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torch/distributed/launch.py:207: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use-env is set by default in torchrun.
If your script expects `--local-rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  main()
/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/export/home/sheid/.local/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
Using cache found in /export/scratch/sheid/.cache/torch/hub/facebookresearch_dinov2_main
/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/export/home/sheid/.local/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
2025-08-17 16:34:36,037 - PixArt - INFO - Distributed environment: MULTI_GPU  Backend: nccl
Num processes: 2
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: bf16

2025-08-17 16:34:36,125 - PixArt - INFO - Config: 
data_root = 'pixart-sigma-toy-dataset'
data = dict(
    type='InternalDataMSSigma',
    root=
    '/export/data/vislearn/rother_subgroup/sheid/pixart/laion2M/feature_pixart',
    image_list_json=['data_info.json'],
    transform='default_train',
    load_vae_feat=False,
    load_t5_feat=True,
    img_root=
    '/export/data/vislearn/rother_subgroup/rother_datasets/LaionAE/laion2B-en-art_512/',
    load_img_vae_feat=True)
image_size = 512
train_batch_size = 8
eval_batch_size = 16
use_fsdp = False
valid_num = 0
fp32_attention = False
model = 'PixArtMS_XL_2'
aspect_ratio_type = 'ASPECT_RATIO_512'
multi_scale = False
pe_interpolation = 1.0
qk_norm = False
kv_compress = False
kv_compress_config = dict(sampling=None, scale_factor=1, kv_compress_layer=[])
num_workers = 3
train_sampling_steps = 1000
visualize = True
deterministic_validation = False
eval_sampling_steps = 500
model_max_length = 300
lora_rank = 4
num_epochs = 1
gradient_accumulation_steps = 1
grad_checkpointing = True
gradient_clip = 0.01
gc_step = 1
auto_lr = dict(rule='sqrt')
validation_prompts = [
    'dog',
    'portrait photo of a girl, photograph, highly detailed face, depth of field',
    'Self-portrait oil painting, a beautiful cyborg with golden hair, 8k',
    'Astronaut in a jungle, cold color palette, muted colors, detailed, 8k',
    'A photo of beautiful mountain with realistic sunset and blue lake, highly detailed, masterpiece'
]
optimizer = dict(
    type='CAMEWrapper',
    lr=2e-05,
    weight_decay=0.03,
    eps=(1e-30, 1e-16),
    betas=(0.9, 0.999, 0.9999))
lr_schedule = 'constant'
lr_schedule_args = dict(num_warmup_steps=1000)
save_image_epochs = 1
save_model_epochs = 1
save_model_steps = 38000
sample_posterior = True
mixed_precision = 'bf16'
scale_factor = 0.13025
ema_rate = 0.9999
tensorboard_mox_interval = 50
log_interval = 20
cfg_scale = 4
mask_type = 'null'
num_group_tokens = 0
mask_loss_coef = 0.0
load_mask_index = False
vae_pretrained = '/export/scratch/sheid/pixart/pixart_sigma_sdxlvae_T5_diffusers/vae'
load_from = '/export/data/sheid/pixart/repa_distillation_attempt/PixArt_sigma_xl2_img512_laion_17_15_8_20_12_24_11_16_13/checkpoints/epoch_1_step_38000.pth'
resume_from = None
snr_loss = False
real_prompt_ratio = 1.0
class_dropout_prob = 0.1
work_dir = '/export/data/sheid/pixart/repa_distillation_attempt/PixArt_sigma_xl2_img512_laion_17_15_8_20_12_24_11_16_13_finetuning'
s3_work_dir = None
micro_condition = False
seed = 43
skip_step = 0
loss_type = 'huber'
huber_c = 0.001
num_ddim_timesteps = 50
w_max = 15.0
w_min = 3.0
ema_decay = 0.95
intermediate_loss_flag = True
intermediate_loss_blocks = [8, 9, 13, 17, 18, 19, 20, 21, 22, 24, 25, 26, 27]
final_output_loss_flag = True
transformer_blocks = [8, 15, 17, 20, 12, 24, 11, 16, 13]
trainable_blocks = []
skip_connections = False
repa_flag = True
repa_depth = 8
reserve_memory = True
image_list_json = ['data_info.json']
ref_load_from = '/export/scratch/sheid/pixart/PixArt-Sigma-XL-2-512-MS.pth'
org_loss_flag = False
dino_version = 'dinov2_vitg14'

2025-08-17 16:34:36,125 - PixArt - INFO - World_size: 2, seed: 43
2025-08-17 16:34:36,125 - PixArt - INFO - Initializing: DDP for training
2025-08-17 16:34:36,125 - PixArt - INFO - vae scale factor: 0.13025
2025-08-17 16:34:36,126 - PixArt - INFO - Preparing Visualization prompt embeddings...
2025-08-17 16:34:36,126 - PixArt - INFO - Loading text encoder and tokenizer from /export/scratch/sheid/pixart/pixart_sigma_sdxlvae_T5_diffusers ...
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.89s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.91s/it]
Using cache found in /export/scratch/sheid/.cache/torch/hub/facebookresearch_dinov2_main
2025-08-17 16:35:09,823 - PixArt - WARNING - position embed interpolation: 1.0, base size: 32
2025-08-17 16:35:09,823 - PixArt - WARNING - kv compress config: {'sampling': None, 'scale_factor': 1, 'kv_compress_layer': []}
2025-08-17 16:35:21,904 - PixArt - WARNING - position embed interpolation: 1.0, base size: 32
2025-08-17 16:35:21,904 - PixArt - WARNING - kv compress config: {'sampling': None, 'scale_factor': 1, 'kv_compress_layer': []}
2025-08-17 16:35:28,004 - PixArt - INFO - PixArtMS Model Parameters: 620,561,056
2025-08-17 16:35:31,415 - PixArt - INFO - Load checkpoint from /export/data/sheid/pixart/repa_distillation_attempt/PixArt_sigma_xl2_img512_laion_17_15_8_20_12_24_11_16_13/checkpoints/epoch_1_step_38000.pth. Load ema: False.
2025-08-17 16:35:32,301 - PixArt - INFO - Load checkpoint from /export/scratch/sheid/pixart/PixArt-Sigma-XL-2-512-MS.pth. Load ema: False.
2025-08-17 16:35:32,303 - PixArt - WARNING - Missing keys: ['pos_embed', 'blocks.8.scale_shift_table', 'blocks.8.attn.qkv.weight', 'blocks.8.attn.qkv.bias', 'blocks.8.attn.proj.weight', 'blocks.8.attn.proj.bias', 'blocks.8.cross_attn.q_linear.weight', 'blocks.8.cross_attn.q_linear.bias', 'blocks.8.cross_attn.kv_linear.weight', 'blocks.8.cross_attn.kv_linear.bias', 'blocks.8.cross_attn.proj.weight', 'blocks.8.cross_attn.proj.bias', 'blocks.8.mlp.fc1.weight', 'blocks.8.mlp.fc1.bias', 'blocks.8.mlp.fc2.weight', 'blocks.8.mlp.fc2.bias', 'blocks.11.scale_shift_table', 'blocks.11.attn.qkv.weight', 'blocks.11.attn.qkv.bias', 'blocks.11.attn.proj.weight', 'blocks.11.attn.proj.bias', 'blocks.11.cross_attn.q_linear.weight', 'blocks.11.cross_attn.q_linear.bias', 'blocks.11.cross_attn.kv_linear.weight', 'blocks.11.cross_attn.kv_linear.bias', 'blocks.11.cross_attn.proj.weight', 'blocks.11.cross_attn.proj.bias', 'blocks.11.mlp.fc1.weight', 'blocks.11.mlp.fc1.bias', 'blocks.11.mlp.fc2.weight', 'blocks.11.mlp.fc2.bias', 'blocks.12.scale_shift_table', 'blocks.12.attn.qkv.weight', 'blocks.12.attn.qkv.bias', 'blocks.12.attn.proj.weight', 'blocks.12.attn.proj.bias', 'blocks.12.cross_attn.q_linear.weight', 'blocks.12.cross_attn.q_linear.bias', 'blocks.12.cross_attn.kv_linear.weight', 'blocks.12.cross_attn.kv_linear.bias', 'blocks.12.cross_attn.proj.weight', 'blocks.12.cross_attn.proj.bias', 'blocks.12.mlp.fc1.weight', 'blocks.12.mlp.fc1.bias', 'blocks.12.mlp.fc2.weight', 'blocks.12.mlp.fc2.bias', 'blocks.13.scale_shift_table', 'blocks.13.attn.qkv.weight', 'blocks.13.attn.qkv.bias', 'blocks.13.attn.proj.weight', 'blocks.13.attn.proj.bias', 'blocks.13.cross_attn.q_linear.weight', 'blocks.13.cross_attn.q_linear.bias', 'blocks.13.cross_attn.kv_linear.weight', 'blocks.13.cross_attn.kv_linear.bias', 'blocks.13.cross_attn.proj.weight', 'blocks.13.cross_attn.proj.bias', 'blocks.13.mlp.fc1.weight', 'blocks.13.mlp.fc1.bias', 'blocks.13.mlp.fc2.weight', 'blocks.13.mlp.fc2.bias', 'blocks.15.scale_shift_table', 'blocks.15.attn.qkv.weight', 'blocks.15.attn.qkv.bias', 'blocks.15.attn.proj.weight', 'blocks.15.attn.proj.bias', 'blocks.15.cross_attn.q_linear.weight', 'blocks.15.cross_attn.q_linear.bias', 'blocks.15.cross_attn.kv_linear.weight', 'blocks.15.cross_attn.kv_linear.bias', 'blocks.15.cross_attn.proj.weight', 'blocks.15.cross_attn.proj.bias', 'blocks.15.mlp.fc1.weight', 'blocks.15.mlp.fc1.bias', 'blocks.15.mlp.fc2.weight', 'blocks.15.mlp.fc2.bias', 'blocks.16.scale_shift_table', 'blocks.16.attn.qkv.weight', 'blocks.16.attn.qkv.bias', 'blocks.16.attn.proj.weight', 'blocks.16.attn.proj.bias', 'blocks.16.cross_attn.q_linear.weight', 'blocks.16.cross_attn.q_linear.bias', 'blocks.16.cross_attn.kv_linear.weight', 'blocks.16.cross_attn.kv_linear.bias', 'blocks.16.cross_attn.proj.weight', 'blocks.16.cross_attn.proj.bias', 'blocks.16.mlp.fc1.weight', 'blocks.16.mlp.fc1.bias', 'blocks.16.mlp.fc2.weight', 'blocks.16.mlp.fc2.bias', 'blocks.17.scale_shift_table', 'blocks.17.attn.qkv.weight', 'blocks.17.attn.qkv.bias', 'blocks.17.attn.proj.weight', 'blocks.17.attn.proj.bias', 'blocks.17.cross_attn.q_linear.weight', 'blocks.17.cross_attn.q_linear.bias', 'blocks.17.cross_attn.kv_linear.weight', 'blocks.17.cross_attn.kv_linear.bias', 'blocks.17.cross_attn.proj.weight', 'blocks.17.cross_attn.proj.bias', 'blocks.17.mlp.fc1.weight', 'blocks.17.mlp.fc1.bias', 'blocks.17.mlp.fc2.weight', 'blocks.17.mlp.fc2.bias', 'blocks.20.scale_shift_table', 'blocks.20.attn.qkv.weight', 'blocks.20.attn.qkv.bias', 'blocks.20.attn.proj.weight', 'blocks.20.attn.proj.bias', 'blocks.20.cross_attn.q_linear.weight', 'blocks.20.cross_attn.q_linear.bias', 'blocks.20.cross_attn.kv_linear.weight', 'blocks.20.cross_attn.kv_linear.bias', 'blocks.20.cross_attn.proj.weight', 'blocks.20.cross_attn.proj.bias', 'blocks.20.mlp.fc1.weight', 'blocks.20.mlp.fc1.bias', 'blocks.20.mlp.fc2.weight', 'blocks.20.mlp.fc2.bias', 'blocks.24.scale_shift_table', 'blocks.24.attn.qkv.weight', 'blocks.24.attn.qkv.bias', 'blocks.24.attn.proj.weight', 'blocks.24.attn.proj.bias', 'blocks.24.cross_attn.q_linear.weight', 'blocks.24.cross_attn.q_linear.bias', 'blocks.24.cross_attn.kv_linear.weight', 'blocks.24.cross_attn.kv_linear.bias', 'blocks.24.cross_attn.proj.weight', 'blocks.24.cross_attn.proj.bias', 'blocks.24.mlp.fc1.weight', 'blocks.24.mlp.fc1.bias', 'blocks.24.mlp.fc2.weight', 'blocks.24.mlp.fc2.bias', 'repa_mlp.proj.0.weight', 'repa_mlp.proj.0.bias', 'repa_mlp.proj.2.weight', 'repa_mlp.proj.2.bias', 'repa_mlp.proj.4.weight', 'repa_mlp.proj.4.bias']
2025-08-17 16:35:32,303 - PixArt - WARNING - Unexpected keys: []
2025-08-17 16:35:32,305 - PixArt - INFO - PixArtMS Model Parameters: 429,261,088
2025-08-17 16:35:32,305 - PixArt - INFO - PixArtMS Trainable Model Parameters: 429,261,088
2025-08-17 16:35:32,306 - PixArt - INFO - Constructing dataset InternalDataMSSigma...
2025-08-17 16:35:32,306 - PixArt - INFO - T5 max token length: 300
2025-08-17 16:35:32,306 - PixArt - INFO - ratio of real user prompt: 1.0
2025-08-17 16:35:34,671 - PixArt - INFO - data_info.json data volume: 608000
2025-08-17 16:35:41,281 - PixArt - INFO - Dataset InternalDataMSSigma constructed. time: 8.98 s, length (use/ori): 607997/608000
2025-08-17 16:35:41,283 - PixArt - INFO - Automatically adapt lr to 0.00001 (using sqrt scaling rule).
2025-08-17 16:35:41,307 - PixArt - INFO - CAMEWrapper Optimizer: total 306 param groups, 306 are learnable, 0 are fix. Lr group: 306 params with lr 0.00001; Weight decay group: 306 params with weight decay 0.03.
2025-08-17 16:35:41,307 - PixArt - INFO - Lr schedule: constant, num_warmup_steps:1000.
  0%|          | 0/38000 [00:00<?, ?it/s]  0%|          | 0/38000 [00:00<?, ?it/s]2025-08-17 16:35:46,514 - PixArt - INFO - Step/Epoch [1/1][1/38000]:total_eta: 1 day, 12:05:41, epoch_eta:18:02:50, time_all:0.171, time_data:0.050, lr:1.000e-08, s:(32, 32), loss:0.2461, grad_norm:0.4590, repa_loss:-0.0063
  0%|          | 1/38000 [00:03<35:24:56,  3.36s/it]2025-08-17 16:35:46,528 - PixArt - INFO - Running validation... 

  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|█▌        | 2/13 [00:00<00:00, 19.32it/s][A
 31%|███       | 4/13 [00:00<00:00, 19.42it/s][A
 46%|████▌     | 6/13 [00:00<00:00, 19.42it/s][A
 62%|██████▏   | 8/13 [00:00<00:00, 19.46it/s][A
 77%|███████▋  | 10/13 [00:00<00:00, 19.51it/s][A
 92%|█████████▏| 12/13 [00:00<00:00, 19.53it/s][A100%|██████████| 13/13 [00:00<00:00, 20.98it/s]

  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|█▌        | 2/13 [00:00<00:00, 19.49it/s][A
 31%|███       | 4/13 [00:00<00:00, 19.51it/s][A
 46%|████▌     | 6/13 [00:00<00:00, 19.43it/s][A
 62%|██████▏   | 8/13 [00:00<00:00, 19.54it/s][A
 77%|███████▋  | 10/13 [00:00<00:00, 19.56it/s][A
 92%|█████████▏| 12/13 [00:00<00:00, 19.50it/s][A100%|██████████| 13/13 [00:00<00:00, 21.01it/s]

  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|█▌        | 2/13 [00:00<00:00, 19.60it/s][A
 31%|███       | 4/13 [00:00<00:00, 19.40it/s][A
 46%|████▌     | 6/13 [00:00<00:00, 19.53it/s][A
 62%|██████▏   | 8/13 [00:00<00:00, 19.53it/s][A
 77%|███████▋  | 10/13 [00:00<00:00, 19.55it/s][A
 92%|█████████▏| 12/13 [00:00<00:00, 19.51it/s][A100%|██████████| 13/13 [00:00<00:00, 21.02it/s]

  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|█▌        | 2/13 [00:00<00:00, 19.41it/s][A
 31%|███       | 4/13 [00:00<00:00, 19.52it/s][A
 46%|████▌     | 6/13 [00:00<00:00, 19.47it/s][A
 62%|██████▏   | 8/13 [00:00<00:00, 19.48it/s][A
 77%|███████▋  | 10/13 [00:00<00:00, 19.51it/s][A
 92%|█████████▏| 12/13 [00:00<00:00, 19.56it/s][A100%|██████████| 13/13 [00:00<00:00, 21.03it/s]

  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|█▌        | 2/13 [00:00<00:00, 19.08it/s][A
 31%|███       | 4/13 [00:00<00:00, 19.34it/s][A
 46%|████▌     | 6/13 [00:00<00:00, 19.43it/s][A
 62%|██████▏   | 8/13 [00:00<00:00, 19.54it/s][A
 77%|███████▋  | 10/13 [00:00<00:00, 19.49it/s][A
 92%|█████████▏| 12/13 [00:00<00:00, 19.45it/s][A100%|██████████| 13/13 [00:00<00:00, 20.93it/s]
  0%|          | 1/38000 [00:09<100:41:42,  9.54s/it]  0%|          | 2/38000 [00:10<57:56:03,  5.49s/it]  0%|          | 2/38000 [00:10<46:53:58,  4.44s/it]   0%|          | 3/38000 [00:11<35:27:12,  3.36s/it]  0%|          | 3/38000 [00:11<29:27:39,  2.79s/it]  0%|          | 4/38000 [00:11<24:54:25,  2.36s/it]  0%|          | 4/38000 [00:12<21:17:00,  2.02s/it]  0%|          | 5/38000 [00:12<19:04:09,  1.81s/it]  0%|          | 5/38000 [00:12<16:44:54,  1.59s/it]  0%|          | 6/38000 [00:13<15:32:50,  1.47s/it]  0%|          | 6/38000 [00:13<14:00:52,  1.33s/it]  0%|          | 7/38000 [00:14<13:20:12,  1.26s/it]  0%|          | 7/38000 [00:14<12:18:14,  1.17s/it]  0%|          | 8/38000 [00:15<11:53:30,  1.13s/it]  0%|          | 8/38000 [00:15<11:11:09,  1.06s/it]  0%|          | 9/38000 [00:16<10:53:18,  1.03s/it]  0%|          | 9/38000 [00:16<10:24:32,  1.01it/s]  0%|          | 10/38000 [00:16<10:13:34,  1.03it/s]  0%|          | 10/38000 [00:17<9:53:24,  1.07it/s]  0%|          | 11/38000 [00:17<9:46:47,  1.08it/s]   0%|          | 11/38000 [00:17<9:32:49,  1.11it/s]  0%|          | 12/38000 [00:18<9:26:45,  1.12it/s]  0%|          | 12/38000 [00:18<9:17:01,  1.14it/s]  0%|          | 13/38000 [00:19<9:13:41,  1.14it/s]  0%|          | 13/38000 [00:19<9:06:45,  1.16it/s]  0%|          | 14/38000 [00:20<9:06:22,  1.16it/s]  0%|          | 14/38000 [00:20<9:01:46,  1.17it/s]  0%|          | 15/38000 [00:21<8:58:56,  1.17it/s]  0%|          | 15/38000 [00:21<8:56:10,  1.18it/s]  0%|          | 16/38000 [00:21<8:54:53,  1.18it/s]  0%|          | 16/38000 [00:22<8:52:45,  1.19it/s]  0%|          | 17/38000 [00:22<8:50:56,  1.19it/s]  0%|          | 17/38000 [00:22<8:50:41,  1.19it/s]  0%|          | 18/38000 [00:23<8:50:12,  1.19it/s]  0%|          | 18/38000 [00:23<8:48:37,  1.20it/s]  0%|          | 19/38000 [00:24<8:48:01,  1.20it/s]  0%|          | 19/38000 [00:24<8:46:50,  1.20it/s]2025-08-17 16:36:08,407 - PixArt - INFO - Step/Epoch [20/1][20/38000]:total_eta: 1 day, 1:26:22, epoch_eta:12:42:59, time_all:1.095, time_data:0.309, lr:2.000e-07, s:(32, 32), loss:0.2225, grad_norm:0.5952, repa_loss:-0.0205
  0%|          | 20/38000 [00:25<8:46:09,  1.20it/s]  0%|          | 20/38000 [00:25<8:45:18,  1.20it/s]  0%|          | 21/38000 [00:26<8:42:40,  1.21it/s]  0%|          | 21/38000 [00:26<8:42:14,  1.21it/s]  0%|          | 22/38000 [00:26<8:40:59,  1.21it/s]  0%|          | 22/38000 [00:26<8:40:40,  1.22it/s]  0%|          | 23/38000 [00:27<8:41:06,  1.21it/s]  0%|          | 23/38000 [00:27<8:40:52,  1.22it/s]  0%|          | 24/38000 [00:28<8:42:25,  1.21it/s]  0%|          | 24/38000 [00:28<8:42:08,  1.21it/s]  0%|          | 25/38000 [00:29<8:42:26,  1.21it/s]  0%|          | 25/38000 [00:29<8:42:24,  1.21it/s]  0%|          | 26/38000 [00:30<8:42:18,  1.21it/s]  0%|          | 26/38000 [00:30<8:42:16,  1.21it/s]  0%|          | 27/38000 [00:31<8:42:26,  1.21it/s]  0%|          | 27/38000 [00:31<8:42:28,  1.21it/s]  0%|          | 28/38000 [00:31<8:42:24,  1.21it/s]  0%|          | 28/38000 [00:31<8:42:15,  1.21it/s]  0%|          | 29/38000 [00:32<8:42:33,  1.21it/s]  0%|          | 29/38000 [00:32<8:42:38,  1.21it/s]  0%|          | 30/38000 [00:33<8:41:55,  1.21it/s]  0%|          | 30/38000 [00:33<8:41:52,  1.21it/s]  0%|          | 31/38000 [00:34<8:39:11,  1.22it/s]  0%|          | 31/38000 [00:34<8:39:21,  1.22it/s]  0%|          | 32/38000 [00:35<8:40:13,  1.22it/s]  0%|          | 32/38000 [00:35<8:40:06,  1.22it/s]  0%|          | 33/38000 [00:35<8:40:11,  1.22it/s]  0%|          | 33/38000 [00:36<8:39:49,  1.22it/s]  0%|          | 34/38000 [00:36<8:40:13,  1.22it/s]  0%|          | 34/38000 [00:36<8:40:15,  1.22it/s]  0%|          | 35/38000 [00:37<8:39:31,  1.22it/s]  0%|          | 35/38000 [00:37<8:39:36,  1.22it/s]  0%|          | 36/38000 [00:38<8:38:08,  1.22it/s]  0%|          | 36/38000 [00:38<8:38:20,  1.22it/s]  0%|          | 37/38000 [00:39<8:40:22,  1.22it/s]  0%|          | 37/38000 [00:39<8:40:02,  1.22it/s]  0%|          | 38/38000 [00:40<8:41:31,  1.21it/s]  0%|          | 38/38000 [00:40<8:41:28,  1.21it/s]  0%|          | 39/38000 [00:40<8:43:25,  1.21it/s]  0%|          | 39/38000 [00:40<8:43:20,  1.21it/s]2025-08-17 16:36:24,882 - PixArt - INFO - Step/Epoch [40/1][40/38000]:total_eta: 21:30:18, epoch_eta:10:44:49, time_all:0.824, time_data:0.003, lr:4.000e-07, s:(32, 32), loss:0.1932, grad_norm:0.5440, repa_loss:-0.1146
  0%|          | 40/38000 [00:41<8:44:37,  1.21it/s]  0%|          | 40/38000 [00:41<8:44:24,  1.21it/s]  0%|          | 41/38000 [00:42<8:44:01,  1.21it/s]  0%|          | 41/38000 [00:42<8:44:06,  1.21it/s]  0%|          | 42/38000 [00:43<8:37:33,  1.22it/s]  0%|          | 42/38000 [00:43<8:37:30,  1.22it/s]  0%|          | 43/38000 [00:44<8:39:51,  1.22it/s]  0%|          | 43/38000 [00:44<8:40:10,  1.22it/s]  0%|          | 44/38000 [00:45<8:42:13,  1.21it/s]  0%|          | 44/38000 [00:45<8:42:30,  1.21it/s]  0%|          | 45/38000 [00:45<8:41:41,  1.21it/s]  0%|          | 45/38000 [00:45<8:41:45,  1.21it/s]  0%|          | 46/38000 [00:46<8:41:53,  1.21it/s]  0%|          | 46/38000 [00:46<8:41:38,  1.21it/s]  0%|          | 47/38000 [00:47<8:38:41,  1.22it/s]  0%|          | 47/38000 [00:47<8:38:41,  1.22it/s]  0%|          | 48/38000 [00:48<8:37:45,  1.22it/s]  0%|          | 48/38000 [00:48<8:37:26,  1.22it/s]  0%|          | 49/38000 [00:49<8:39:49,  1.22it/s]  0%|          | 49/38000 [00:49<8:39:45,  1.22it/s]  0%|          | 50/38000 [00:49<8:40:15,  1.22it/s]  0%|          | 50/38000 [00:50<8:40:26,  1.22it/s]  0%|          | 51/38000 [00:50<8:40:28,  1.22it/s]  0%|          | 51/38000 [00:50<8:40:27,  1.22it/s]  0%|          | 52/38000 [00:51<8:41:31,  1.21it/s]  0%|          | 52/38000 [00:51<8:41:41,  1.21it/s]  0%|          | 53/38000 [00:52<8:42:10,  1.21it/s]  0%|          | 53/38000 [00:52<8:41:55,  1.21it/s]  0%|          | 54/38000 [00:53<8:43:24,  1.21it/s]  0%|          | 54/38000 [00:53<8:43:27,  1.21it/s]  0%|          | 55/38000 [00:54<8:43:49,  1.21it/s]  0%|          | 55/38000 [00:54<8:44:02,  1.21it/s]  0%|          | 56/38000 [00:54<8:44:00,  1.21it/s]  0%|          | 56/38000 [00:54<8:44:00,  1.21it/s]  0%|          | 57/38000 [00:55<8:42:54,  1.21it/s]  0%|          | 57/38000 [00:55<8:43:04,  1.21it/s]  0%|          | 58/38000 [00:56<8:40:23,  1.22it/s]  0%|          | 58/38000 [00:56<8:40:13,  1.22it/s]  0%|          | 59/38000 [00:57<8:42:15,  1.21it/s]  0%|          | 59/38000 [00:57<8:42:35,  1.21it/s]2025-08-17 16:36:41,364 - PixArt - INFO - Step/Epoch [60/1][60/38000]:total_eta: 20:09:00, epoch_eta:10:04:01, time_all:0.824, time_data:0.003, lr:6.000e-07, s:(32, 32), loss:0.1271, grad_norm:0.5130, repa_loss:-0.2397
  0%|          | 60/38000 [00:58<8:43:02,  1.21it/s]  0%|          | 60/38000 [00:58<8:42:52,  1.21it/s]  0%|          | 61/38000 [00:59<8:41:50,  1.21it/s]  0%|          | 61/38000 [00:59<8:41:54,  1.21it/s]  0%|          | 62/38000 [00:59<8:43:55,  1.21it/s]  0%|          | 62/38000 [00:59<8:43:53,  1.21it/s]  0%|          | 63/38000 [01:00<8:43:35,  1.21it/s]  0%|          | 63/38000 [01:00<8:43:24,  1.21it/s]  0%|          | 64/38000 [01:01<8:43:52,  1.21it/s]  0%|          | 64/38000 [01:01<8:43:46,  1.21it/s]  0%|          | 65/38000 [01:02<8:45:21,  1.20it/s]  0%|          | 65/38000 [01:02<8:45:41,  1.20it/s]  0%|          | 66/38000 [01:03<8:45:39,  1.20it/s]  0%|          | 66/38000 [01:03<8:45:41,  1.20it/s]  0%|          | 67/38000 [01:04<8:46:52,  1.20it/s]  0%|          | 67/38000 [01:04<8:46:46,  1.20it/s]  0%|          | 68/38000 [01:04<8:46:31,  1.20it/s]  0%|          | 68/38000 [01:04<8:46:21,  1.20it/s]  0%|          | 69/38000 [01:05<8:46:29,  1.20it/s]  0%|          | 69/38000 [01:05<8:46:21,  1.20it/s]  0%|          | 70/38000 [01:06<8:43:47,  1.21it/s]  0%|          | 70/38000 [01:06<8:43:59,  1.21it/s]  0%|          | 71/38000 [01:07<8:44:24,  1.21it/s]  0%|          | 71/38000 [01:07<8:44:28,  1.21it/s]  0%|          | 72/38000 [01:08<8:44:40,  1.20it/s]  0%|          | 72/38000 [01:08<8:44:41,  1.20it/s]  0%|          | 73/38000 [01:08<8:44:00,  1.21it/s]  0%|          | 73/38000 [01:09<8:43:52,  1.21it/s]  0%|          | 74/38000 [01:09<8:43:19,  1.21it/s]  0%|          | 74/38000 [01:09<8:43:29,  1.21it/s]  0%|          | 75/38000 [01:10<8:43:10,  1.21it/s]  0%|          | 75/38000 [01:10<8:43:03,  1.21it/s]  0%|          | 76/38000 [01:11<8:44:35,  1.20it/s]  0%|          | 76/38000 [01:11<8:44:37,  1.20it/s]  0%|          | 77/38000 [01:12<8:43:47,  1.21it/s]  0%|          | 77/38000 [01:12<8:43:30,  1.21it/s]  0%|          | 78/38000 [01:13<8:44:02,  1.21it/s]  0%|          | 78/38000 [01:13<8:43:52,  1.21it/s]  0%|          | 79/38000 [01:13<8:43:52,  1.21it/s]  0%|          | 79/38000 [01:14<8:44:09,  1.21it/s]2025-08-17 16:36:57,956 - PixArt - INFO - Step/Epoch [80/1][80/38000]:total_eta: 19:29:25, epoch_eta:9:44:06, time_all:0.830, time_data:0.003, lr:8.000e-07, s:(32, 32), loss:0.0849, grad_norm:0.5471, repa_loss:-0.3212
  0%|          | 80/38000 [01:14<8:43:25,  1.21it/s]  0%|          | 80/38000 [01:14<8:43:36,  1.21it/s]  0%|          | 81/38000 [01:15<8:42:37,  1.21it/s]  0%|          | 81/38000 [01:15<8:42:36,  1.21it/s]  0%|          | 82/38000 [01:16<8:43:41,  1.21it/s]  0%|          | 82/38000 [01:16<8:43:43,  1.21it/s]  0%|          | 83/38000 [01:17<8:45:19,  1.20it/s]  0%|          | 83/38000 [01:17<8:45:13,  1.20it/s]  0%|          | 84/38000 [01:18<8:48:22,  1.20it/s]  0%|          | 84/38000 [01:18<8:48:12,  1.20it/s]  0%|          | 85/38000 [01:18<8:48:17,  1.20it/s]  0%|          | 85/38000 [01:19<8:48:21,  1.20it/s]  0%|          | 86/38000 [01:19<8:46:05,  1.20it/s]  0%|          | 86/38000 [01:19<8:46:24,  1.20it/s]  0%|          | 87/38000 [01:20<8:46:04,  1.20it/s]  0%|          | 87/38000 [01:20<8:46:05,  1.20it/s]  0%|          | 88/38000 [01:21<8:45:26,  1.20it/s]  0%|          | 88/38000 [01:21<8:45:17,  1.20it/s]  0%|          | 89/38000 [01:22<8:44:41,  1.20it/s]  0%|          | 89/38000 [01:22<8:44:50,  1.20it/s]  0%|          | 90/38000 [01:23<8:45:35,  1.20it/s]  0%|          | 90/38000 [01:23<8:45:26,  1.20it/s]  0%|          | 91/38000 [01:23<8:46:46,  1.20it/s]  0%|          | 91/38000 [01:24<8:46:55,  1.20it/s]  0%|          | 92/38000 [01:24<8:44:11,  1.21it/s]  0%|          | 92/38000 [01:24<8:43:58,  1.21it/s]  0%|          | 93/38000 [01:25<8:42:32,  1.21it/s]  0%|          | 93/38000 [01:25<8:42:32,  1.21it/s]  0%|          | 94/38000 [01:26<8:44:10,  1.21it/s]  0%|          | 94/38000 [01:26<8:44:18,  1.20it/s]  0%|          | 95/38000 [01:27<8:45:20,  1.20it/s]  0%|          | 95/38000 [01:27<8:45:17,  1.20it/s]  0%|          | 96/38000 [01:28<8:44:15,  1.20it/s]  0%|          | 96/38000 [01:28<8:44:23,  1.20it/s]  0%|          | 97/38000 [01:28<8:40:11,  1.21it/s]  0%|          | 97/38000 [01:28<8:40:15,  1.21it/s]  0%|          | 98/38000 [01:29<8:41:16,  1.21it/s]  0%|          | 98/38000 [01:29<8:41:07,  1.21it/s]  0%|          | 99/38000 [01:30<8:43:33,  1.21it/s]  0%|          | 99/38000 [01:30<8:43:33,  1.21it/s]2025-08-17 16:37:14,560 - PixArt - INFO - Step/Epoch [100/1][100/38000]:total_eta: 19:05:34, epoch_eta:9:32:02, time_all:0.830, time_data:0.003, lr:1.000e-06, s:(32, 32), loss:0.0546, grad_norm:0.4505, repa_loss:-0.3600
  0%|          | 100/38000 [01:31<8:42:53,  1.21it/s]  0%|          | 100/38000 [01:31<8:43:04,  1.21it/s]  0%|          | 101/38000 [01:32<8:42:27,  1.21it/s]  0%|          | 101/38000 [01:32<8:42:26,  1.21it/s]  0%|          | 102/38000 [01:33<8:41:44,  1.21it/s]  0%|          | 102/38000 [01:33<8:41:40,  1.21it/s]  0%|          | 103/38000 [01:33<8:43:04,  1.21it/s]  0%|          | 103/38000 [01:33<8:42:41,  1.21it/s]  0%|          | 104/38000 [01:34<8:42:39,  1.21it/s]  0%|          | 104/38000 [01:34<8:42:53,  1.21it/s]  0%|          | 105/38000 [01:35<8:42:41,  1.21it/s]  0%|          | 105/38000 [01:35<8:42:32,  1.21it/s]  0%|          | 106/38000 [01:36<8:42:19,  1.21it/s]  0%|          | 106/38000 [01:36<8:42:34,  1.21it/s]  0%|          | 107/38000 [01:37<8:42:11,  1.21it/s]  0%|          | 107/38000 [01:37<8:42:05,  1.21it/s]  0%|          | 108/38000 [01:38<8:44:08,  1.20it/s]  0%|          | 108/38000 [01:38<8:44:00,  1.21it/s]  0%|          | 109/38000 [01:38<8:43:51,  1.21it/s]  0%|          | 109/38000 [01:38<8:43:43,  1.21it/s]  0%|          | 110/38000 [01:39<8:44:52,  1.20it/s]  0%|          | 110/38000 [01:39<8:45:01,  1.20it/s]  0%|          | 111/38000 [01:40<8:45:29,  1.20it/s]  0%|          | 111/38000 [01:40<8:45:32,  1.20it/s]  0%|          | 112/38000 [01:41<8:42:00,  1.21it/s]  0%|          | 112/38000 [01:41<8:42:00,  1.21it/s]  0%|          | 113/38000 [01:42<8:42:37,  1.21it/s]  0%|          | 113/38000 [01:42<8:42:30,  1.21it/s]  0%|          | 114/38000 [01:42<8:44:02,  1.20it/s]  0%|          | 114/38000 [01:43<8:43:56,  1.21it/s]  0%|          | 115/38000 [01:43<8:43:27,  1.21it/s]  0%|          | 115/38000 [01:43<8:43:38,  1.21it/s]  0%|          | 116/38000 [01:44<8:43:47,  1.21it/s]  0%|          | 116/38000 [01:44<8:44:24,  1.20it/s]  0%|          | 117/38000 [01:45<8:43:43,  1.21it/s]  0%|          | 117/38000 [01:45<8:43:32,  1.21it/s]  0%|          | 118/38000 [01:46<8:44:26,  1.20it/s]  0%|          | 118/38000 [01:46<8:44:15,  1.20it/s]  0%|          | 119/38000 [01:47<8:44:12,  1.20it/s]  0%|          | 119/38000 [01:47<8:44:05,  1.20it/s]2025-08-17 16:37:31,135 - PixArt - INFO - Step/Epoch [120/1][120/38000]:total_eta: 18:49:12, epoch_eta:9:23:43, time_all:0.829, time_data:0.003, lr:1.200e-06, s:(32, 32), loss:0.0353, grad_norm:0.4793, repa_loss:-0.3784
  0%|          | 120/38000 [01:47<8:42:53,  1.21it/s]  0%|          | 120/38000 [01:48<8:42:52,  1.21it/s]  0%|          | 121/38000 [01:48<8:42:02,  1.21it/s]  0%|          | 121/38000 [01:48<8:41:56,  1.21it/s]  0%|          | 122/38000 [01:49<8:40:18,  1.21it/s]  0%|          | 122/38000 [01:49<8:40:30,  1.21it/s]  0%|          | 123/38000 [01:50<8:41:23,  1.21it/s]  0%|          | 123/38000 [01:50<8:41:22,  1.21it/s]  0%|          | 124/38000 [01:51<8:42:51,  1.21it/s]  0%|          | 124/38000 [01:51<8:42:53,  1.21it/s]  0%|          | 125/38000 [01:52<8:43:26,  1.21it/s]  0%|          | 125/38000 [01:52<8:43:14,  1.21it/s]  0%|          | 126/38000 [01:52<8:38:56,  1.22it/s]  0%|          | 126/38000 [01:52<8:38:54,  1.22it/s]  0%|          | 127/38000 [01:53<8:40:56,  1.21it/s]  0%|          | 127/38000 [01:53<8:41:00,  1.21it/s]  0%|          | 128/38000 [01:54<8:40:26,  1.21it/s]  0%|          | 128/38000 [01:54<8:40:31,  1.21it/s]  0%|          | 129/38000 [01:55<8:40:40,  1.21it/s]  0%|          | 129/38000 [01:55<8:40:37,  1.21it/s]  0%|          | 130/38000 [01:56<8:41:21,  1.21it/s]  0%|          | 130/38000 [01:56<8:41:27,  1.21it/s]  0%|          | 131/38000 [01:57<8:36:45,  1.22it/s]  0%|          | 131/38000 [01:57<8:36:39,  1.22it/s]  0%|          | 132/38000 [01:57<8:37:02,  1.22it/s]  0%|          | 132/38000 [01:57<8:36:48,  1.22it/s]  0%|          | 133/38000 [01:58<8:37:57,  1.22it/s]  0%|          | 133/38000 [01:58<8:38:01,  1.22it/s]  0%|          | 134/38000 [01:59<8:39:31,  1.21it/s]  0%|          | 134/38000 [01:59<8:39:41,  1.21it/s]  0%|          | 135/38000 [02:00<8:40:59,  1.21it/s]  0%|          | 135/38000 [02:00<8:40:52,  1.21it/s]  0%|          | 136/38000 [02:01<8:42:32,  1.21it/s]  0%|          | 136/38000 [02:01<8:42:23,  1.21it/s]  0%|          | 137/38000 [02:01<8:43:15,  1.21it/s]  0%|          | 137/38000 [02:02<8:43:17,  1.21it/s]  0%|          | 138/38000 [02:02<8:41:51,  1.21it/s]  0%|          | 138/38000 [02:02<8:42:04,  1.21it/s]  0%|          | 139/38000 [02:03<8:42:26,  1.21it/s]  0%|          | 139/38000 [02:03<8:42:21,  1.21it/s]2025-08-17 16:37:47,641 - PixArt - INFO - Step/Epoch [140/1][140/38000]:total_eta: 18:36:47, epoch_eta:9:17:22, time_all:0.825, time_data:0.003, lr:1.400e-06, s:(32, 32), loss:0.0365, grad_norm:0.4149, repa_loss:-0.3867
  0%|          | 140/38000 [02:04<8:42:37,  1.21it/s]  0%|          | 140/38000 [02:04<8:42:30,  1.21it/s]  0%|          | 141/38000 [02:05<8:43:54,  1.20it/s]  0%|          | 141/38000 [02:05<8:44:00,  1.20it/s]  0%|          | 142/38000 [02:06<8:44:14,  1.20it/s]  0%|          | 142/38000 [02:06<8:44:15,  1.20it/s]  0%|          | 143/38000 [02:06<8:39:39,  1.21it/s]  0%|          | 143/38000 [02:07<8:39:31,  1.21it/s]  0%|          | 144/38000 [02:07<8:40:33,  1.21it/s]  0%|          | 144/38000 [02:07<8:40:39,  1.21it/s]  0%|          | 145/38000 [02:08<8:41:49,  1.21it/s]  0%|          | 145/38000 [02:08<8:41:40,  1.21it/s]  0%|          | 146/38000 [02:09<8:42:29,  1.21it/s]  0%|          | 146/38000 [02:09<8:42:27,  1.21it/s]  0%|          | 147/38000 [02:10<8:43:18,  1.21it/s]  0%|          | 147/38000 [02:10<8:44:05,  1.20it/s]  0%|          | 148/38000 [02:11<8:38:54,  1.22it/s]  0%|          | 148/38000 [02:11<8:38:35,  1.22it/s]  0%|          | 149/38000 [02:11<8:39:03,  1.22it/s]  0%|          | 149/38000 [02:11<8:38:59,  1.22it/s]  0%|          | 150/38000 [02:12<8:40:42,  1.21it/s]  0%|          | 150/38000 [02:12<8:40:19,  1.21it/s]  0%|          | 151/38000 [02:13<8:40:55,  1.21it/s]  0%|          | 151/38000 [02:13<8:41:02,  1.21it/s]  0%|          | 152/38000 [02:14<8:43:07,  1.21it/s]  0%|          | 152/38000 [02:14<8:43:17,  1.21it/s]  0%|          | 153/38000 [02:15<8:44:10,  1.20it/s]  0%|          | 153/38000 [02:15<8:44:11,  1.20it/s]  0%|          | 154/38000 [02:16<8:44:02,  1.20it/s]  0%|          | 154/38000 [02:16<8:43:59,  1.20it/s]  0%|          | 155/38000 [02:16<8:45:08,  1.20it/s]  0%|          | 155/38000 [02:16<8:45:05,  1.20it/s]  0%|          | 156/38000 [02:17<8:44:25,  1.20it/s]  0%|          | 156/38000 [02:17<8:44:10,  1.20it/s]  0%|          | 157/38000 [02:18<8:44:13,  1.20it/s]  0%|          | 157/38000 [02:18<8:44:16,  1.20it/s]  0%|          | 158/38000 [02:19<8:40:36,  1.21it/s]  0%|          | 158/38000 [02:19<8:40:43,  1.21it/s]  0%|          | 159/38000 [02:20<8:39:37,  1.21it/s]  0%|          | 159/38000 [02:20<8:39:31,  1.21it/s]2025-08-17 16:38:04,189 - PixArt - INFO - Step/Epoch [160/1][160/38000]:total_eta: 18:27:42, epoch_eta:9:12:41, time_all:0.827, time_data:0.003, lr:1.600e-06, s:(32, 32), loss:0.0475, grad_norm:0.4412, repa_loss:-0.3981
  0%|          | 160/38000 [02:21<8:41:06,  1.21it/s]  0%|          | 160/38000 [02:21<8:41:10,  1.21it/s]  0%|          | 161/38000 [02:21<8:42:25,  1.21it/s]  0%|          | 161/38000 [02:21<8:42:20,  1.21it/s]  0%|          | 162/38000 [02:22<8:42:10,  1.21it/s]  0%|          | 162/38000 [02:22<8:42:22,  1.21it/s]  0%|          | 163/38000 [02:23<8:38:12,  1.22it/s]  0%|          | 163/38000 [02:23<8:38:14,  1.22it/s]  0%|          | 164/38000 [02:24<8:43:18,  1.21it/s]  0%|          | 164/38000 [02:24<8:43:06,  1.21it/s]  0%|          | 165/38000 [02:25<8:46:42,  1.20it/s]  0%|          | 165/38000 [02:25<8:46:46,  1.20it/s]  0%|          | 166/38000 [02:26<8:48:09,  1.19it/s]  0%|          | 166/38000 [02:26<8:48:12,  1.19it/s]  0%|          | 167/38000 [02:26<8:48:12,  1.19it/s]  0%|          | 167/38000 [02:26<8:48:07,  1.19it/s]