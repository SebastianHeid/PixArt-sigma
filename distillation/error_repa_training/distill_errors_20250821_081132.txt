/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torch/distributed/launch.py:207: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use-env is set by default in torchrun.
If your script expects `--local-rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  main()
/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/export/home/sheid/.local/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
Using cache found in /export/scratch/sheid/.cache/torch/hub/facebookresearch_dinov2_main
/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/export/home/sheid/.local/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/export/scratch/sheid/miniconda3/envs/mmcv_env/lib/python3.10/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
2025-08-21 08:12:01,390 - PixArt - INFO - Distributed environment: MULTI_GPU  Backend: nccl
Num processes: 2
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: bf16

2025-08-21 08:12:01,483 - PixArt - INFO - Config: 
data_root = 'pixart-sigma-toy-dataset'
data = dict(
    type='InternalDataMSSigma',
    root=
    '/export/data/vislearn/rother_subgroup/sheid/pixart/laion2M/feature_pixart',
    image_list_json=['data_info.json'],
    transform='default_train',
    load_vae_feat=False,
    load_t5_feat=True,
    img_root=
    '/export/data/vislearn/rother_subgroup/rother_datasets/LaionAE/laion2B-en-art_512/',
    load_img_vae_feat=True)
image_size = 512
train_batch_size = 16
eval_batch_size = 16
use_fsdp = False
valid_num = 0
fp32_attention = False
model = 'PixArtMS_XL_2'
aspect_ratio_type = 'ASPECT_RATIO_512'
multi_scale = False
pe_interpolation = 1.0
qk_norm = False
kv_compress = False
kv_compress_config = dict(sampling=None, scale_factor=1, kv_compress_layer=[])
num_workers = 3
train_sampling_steps = 1000
visualize = True
deterministic_validation = False
eval_sampling_steps = 500
model_max_length = 300
lora_rank = 4
num_epochs = 1
gradient_accumulation_steps = 1
grad_checkpointing = True
gradient_clip = 0.01
gc_step = 1
auto_lr = dict(rule='sqrt')
validation_prompts = [
    'dog',
    'portrait photo of a girl, photograph, highly detailed face, depth of field',
    'Self-portrait oil painting, a beautiful cyborg with golden hair, 8k',
    'Astronaut in a jungle, cold color palette, muted colors, detailed, 8k',
    'A photo of beautiful mountain with realistic sunset and blue lake, highly detailed, masterpiece'
]
optimizer = dict(
    type='CAMEWrapper',
    lr=2e-05,
    weight_decay=0.03,
    eps=(1e-30, 1e-16),
    betas=(0.9, 0.999, 0.9999))
lr_schedule = 'constant'
lr_schedule_args = dict(num_warmup_steps=1000)
save_image_epochs = 1
save_model_epochs = 1
save_model_steps = 38000
sample_posterior = True
mixed_precision = 'bf16'
scale_factor = 0.13025
ema_rate = 0.9999
tensorboard_mox_interval = 50
log_interval = 20
cfg_scale = 4
mask_type = 'null'
num_group_tokens = 0
mask_loss_coef = 0.0
load_mask_index = False
vae_pretrained = '/export/scratch/sheid/pixart/pixart_sigma_sdxlvae_T5_diffusers/vae'
load_from = '/export/data/sheid/pixart/repa_distillation_attempt/PixArt_sigma_xl2_img512_laion_17_15_8_20_12_24_11_16_13_19_25/checkpoints/epoch_1_step_38000.pth'
resume_from = None
snr_loss = False
real_prompt_ratio = 1.0
class_dropout_prob = 0.1
work_dir = '/export/data/sheid/pixart/repa_distillation_attempt/PixArt_sigma_xl2_img512_laion_17_15_8_20_12_24_11_16_13_19_25_finetuning'
s3_work_dir = None
micro_condition = False
seed = 43
skip_step = 0
loss_type = 'huber'
huber_c = 0.001
num_ddim_timesteps = 50
w_max = 15.0
w_min = 3.0
ema_decay = 0.95
intermediate_loss_flag = True
intermediate_loss_blocks = [8, 9, 13, 17, 19, 20, 21, 22, 25, 26, 27]
final_output_loss_flag = True
transformer_blocks = [8, 15, 17, 20, 12, 24, 11, 16, 13, 19, 25]
trainable_blocks = []
skip_connections = False
repa_flag = True
repa_depth = 8
reserve_memory = True
image_list_json = ['data_info.json']
ref_load_from = '/export/scratch/sheid/pixart/PixArt-Sigma-XL-2-512-MS.pth'
org_loss_flag = False
dino_version = 'dinov2_vitg14'

2025-08-21 08:12:01,483 - PixArt - INFO - World_size: 2, seed: 43
2025-08-21 08:12:01,483 - PixArt - INFO - Initializing: DDP for training
2025-08-21 08:12:01,483 - PixArt - INFO - vae scale factor: 0.13025
2025-08-21 08:12:01,484 - PixArt - INFO - Preparing Visualization prompt embeddings...
2025-08-21 08:12:01,484 - PixArt - INFO - Loading text encoder and tokenizer from /export/scratch/sheid/pixart/pixart_sigma_sdxlvae_T5_diffusers ...
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:29<00:29, 29.89s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:51<00:00, 24.87s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:51<00:00, 25.62s/it]
Using cache found in /export/scratch/sheid/.cache/torch/hub/facebookresearch_dinov2_main
2025-08-21 08:14:06,338 - PixArt - WARNING - position embed interpolation: 1.0, base size: 32
2025-08-21 08:14:06,338 - PixArt - WARNING - kv compress config: {'sampling': None, 'scale_factor': 1, 'kv_compress_layer': []}
2025-08-21 08:14:18,477 - PixArt - WARNING - position embed interpolation: 1.0, base size: 32
2025-08-21 08:14:18,477 - PixArt - WARNING - kv compress config: {'sampling': None, 'scale_factor': 1, 'kv_compress_layer': []}
2025-08-21 08:14:24,806 - PixArt - INFO - PixArtMS Model Parameters: 620,561,056
2025-08-21 08:14:28,354 - PixArt - INFO - Load checkpoint from /export/data/sheid/pixart/repa_distillation_attempt/PixArt_sigma_xl2_img512_laion_17_15_8_20_12_24_11_16_13_19_25/checkpoints/epoch_1_step_38000.pth. Load ema: False.
2025-08-21 08:14:36,946 - PixArt - INFO - Load checkpoint from /export/scratch/sheid/pixart/PixArt-Sigma-XL-2-512-MS.pth. Load ema: False.
2025-08-21 08:14:36,956 - PixArt - WARNING - Missing keys: ['pos_embed', 'blocks.8.scale_shift_table', 'blocks.8.attn.qkv.weight', 'blocks.8.attn.qkv.bias', 'blocks.8.attn.proj.weight', 'blocks.8.attn.proj.bias', 'blocks.8.cross_attn.q_linear.weight', 'blocks.8.cross_attn.q_linear.bias', 'blocks.8.cross_attn.kv_linear.weight', 'blocks.8.cross_attn.kv_linear.bias', 'blocks.8.cross_attn.proj.weight', 'blocks.8.cross_attn.proj.bias', 'blocks.8.mlp.fc1.weight', 'blocks.8.mlp.fc1.bias', 'blocks.8.mlp.fc2.weight', 'blocks.8.mlp.fc2.bias', 'blocks.11.scale_shift_table', 'blocks.11.attn.qkv.weight', 'blocks.11.attn.qkv.bias', 'blocks.11.attn.proj.weight', 'blocks.11.attn.proj.bias', 'blocks.11.cross_attn.q_linear.weight', 'blocks.11.cross_attn.q_linear.bias', 'blocks.11.cross_attn.kv_linear.weight', 'blocks.11.cross_attn.kv_linear.bias', 'blocks.11.cross_attn.proj.weight', 'blocks.11.cross_attn.proj.bias', 'blocks.11.mlp.fc1.weight', 'blocks.11.mlp.fc1.bias', 'blocks.11.mlp.fc2.weight', 'blocks.11.mlp.fc2.bias', 'blocks.12.scale_shift_table', 'blocks.12.attn.qkv.weight', 'blocks.12.attn.qkv.bias', 'blocks.12.attn.proj.weight', 'blocks.12.attn.proj.bias', 'blocks.12.cross_attn.q_linear.weight', 'blocks.12.cross_attn.q_linear.bias', 'blocks.12.cross_attn.kv_linear.weight', 'blocks.12.cross_attn.kv_linear.bias', 'blocks.12.cross_attn.proj.weight', 'blocks.12.cross_attn.proj.bias', 'blocks.12.mlp.fc1.weight', 'blocks.12.mlp.fc1.bias', 'blocks.12.mlp.fc2.weight', 'blocks.12.mlp.fc2.bias', 'blocks.13.scale_shift_table', 'blocks.13.attn.qkv.weight', 'blocks.13.attn.qkv.bias', 'blocks.13.attn.proj.weight', 'blocks.13.attn.proj.bias', 'blocks.13.cross_attn.q_linear.weight', 'blocks.13.cross_attn.q_linear.bias', 'blocks.13.cross_attn.kv_linear.weight', 'blocks.13.cross_attn.kv_linear.bias', 'blocks.13.cross_attn.proj.weight', 'blocks.13.cross_attn.proj.bias', 'blocks.13.mlp.fc1.weight', 'blocks.13.mlp.fc1.bias', 'blocks.13.mlp.fc2.weight', 'blocks.13.mlp.fc2.bias', 'blocks.15.scale_shift_table', 'blocks.15.attn.qkv.weight', 'blocks.15.attn.qkv.bias', 'blocks.15.attn.proj.weight', 'blocks.15.attn.proj.bias', 'blocks.15.cross_attn.q_linear.weight', 'blocks.15.cross_attn.q_linear.bias', 'blocks.15.cross_attn.kv_linear.weight', 'blocks.15.cross_attn.kv_linear.bias', 'blocks.15.cross_attn.proj.weight', 'blocks.15.cross_attn.proj.bias', 'blocks.15.mlp.fc1.weight', 'blocks.15.mlp.fc1.bias', 'blocks.15.mlp.fc2.weight', 'blocks.15.mlp.fc2.bias', 'blocks.16.scale_shift_table', 'blocks.16.attn.qkv.weight', 'blocks.16.attn.qkv.bias', 'blocks.16.attn.proj.weight', 'blocks.16.attn.proj.bias', 'blocks.16.cross_attn.q_linear.weight', 'blocks.16.cross_attn.q_linear.bias', 'blocks.16.cross_attn.kv_linear.weight', 'blocks.16.cross_attn.kv_linear.bias', 'blocks.16.cross_attn.proj.weight', 'blocks.16.cross_attn.proj.bias', 'blocks.16.mlp.fc1.weight', 'blocks.16.mlp.fc1.bias', 'blocks.16.mlp.fc2.weight', 'blocks.16.mlp.fc2.bias', 'blocks.17.scale_shift_table', 'blocks.17.attn.qkv.weight', 'blocks.17.attn.qkv.bias', 'blocks.17.attn.proj.weight', 'blocks.17.attn.proj.bias', 'blocks.17.cross_attn.q_linear.weight', 'blocks.17.cross_attn.q_linear.bias', 'blocks.17.cross_attn.kv_linear.weight', 'blocks.17.cross_attn.kv_linear.bias', 'blocks.17.cross_attn.proj.weight', 'blocks.17.cross_attn.proj.bias', 'blocks.17.mlp.fc1.weight', 'blocks.17.mlp.fc1.bias', 'blocks.17.mlp.fc2.weight', 'blocks.17.mlp.fc2.bias', 'blocks.19.scale_shift_table', 'blocks.19.attn.qkv.weight', 'blocks.19.attn.qkv.bias', 'blocks.19.attn.proj.weight', 'blocks.19.attn.proj.bias', 'blocks.19.cross_attn.q_linear.weight', 'blocks.19.cross_attn.q_linear.bias', 'blocks.19.cross_attn.kv_linear.weight', 'blocks.19.cross_attn.kv_linear.bias', 'blocks.19.cross_attn.proj.weight', 'blocks.19.cross_attn.proj.bias', 'blocks.19.mlp.fc1.weight', 'blocks.19.mlp.fc1.bias', 'blocks.19.mlp.fc2.weight', 'blocks.19.mlp.fc2.bias', 'blocks.20.scale_shift_table', 'blocks.20.attn.qkv.weight', 'blocks.20.attn.qkv.bias', 'blocks.20.attn.proj.weight', 'blocks.20.attn.proj.bias', 'blocks.20.cross_attn.q_linear.weight', 'blocks.20.cross_attn.q_linear.bias', 'blocks.20.cross_attn.kv_linear.weight', 'blocks.20.cross_attn.kv_linear.bias', 'blocks.20.cross_attn.proj.weight', 'blocks.20.cross_attn.proj.bias', 'blocks.20.mlp.fc1.weight', 'blocks.20.mlp.fc1.bias', 'blocks.20.mlp.fc2.weight', 'blocks.20.mlp.fc2.bias', 'blocks.24.scale_shift_table', 'blocks.24.attn.qkv.weight', 'blocks.24.attn.qkv.bias', 'blocks.24.attn.proj.weight', 'blocks.24.attn.proj.bias', 'blocks.24.cross_attn.q_linear.weight', 'blocks.24.cross_attn.q_linear.bias', 'blocks.24.cross_attn.kv_linear.weight', 'blocks.24.cross_attn.kv_linear.bias', 'blocks.24.cross_attn.proj.weight', 'blocks.24.cross_attn.proj.bias', 'blocks.24.mlp.fc1.weight', 'blocks.24.mlp.fc1.bias', 'blocks.24.mlp.fc2.weight', 'blocks.24.mlp.fc2.bias', 'blocks.25.scale_shift_table', 'blocks.25.attn.qkv.weight', 'blocks.25.attn.qkv.bias', 'blocks.25.attn.proj.weight', 'blocks.25.attn.proj.bias', 'blocks.25.cross_attn.q_linear.weight', 'blocks.25.cross_attn.q_linear.bias', 'blocks.25.cross_attn.kv_linear.weight', 'blocks.25.cross_attn.kv_linear.bias', 'blocks.25.cross_attn.proj.weight', 'blocks.25.cross_attn.proj.bias', 'blocks.25.mlp.fc1.weight', 'blocks.25.mlp.fc1.bias', 'blocks.25.mlp.fc2.weight', 'blocks.25.mlp.fc2.bias', 'repa_mlp.proj.0.weight', 'repa_mlp.proj.0.bias', 'repa_mlp.proj.2.weight', 'repa_mlp.proj.2.bias', 'repa_mlp.proj.4.weight', 'repa_mlp.proj.4.bias']
2025-08-21 08:14:36,956 - PixArt - WARNING - Unexpected keys: []
2025-08-21 08:14:36,958 - PixArt - INFO - PixArtMS Model Parameters: 386,749,984
2025-08-21 08:14:36,959 - PixArt - INFO - PixArtMS Trainable Model Parameters: 386,749,984
2025-08-21 08:14:36,959 - PixArt - INFO - Constructing dataset InternalDataMSSigma...
2025-08-21 08:14:36,960 - PixArt - INFO - T5 max token length: 300
2025-08-21 08:14:36,960 - PixArt - INFO - ratio of real user prompt: 1.0
2025-08-21 08:14:39,398 - PixArt - INFO - data_info.json data volume: 608000
2025-08-21 08:14:46,466 - PixArt - INFO - Dataset InternalDataMSSigma constructed. time: 9.51 s, length (use/ori): 607997/608000
2025-08-21 08:14:46,467 - PixArt - INFO - Automatically adapt lr to 0.00001 (using sqrt scaling rule).
2025-08-21 08:14:46,486 - PixArt - INFO - CAMEWrapper Optimizer: total 276 param groups, 276 are learnable, 0 are fix. Lr group: 276 params with lr 0.00001; Weight decay group: 276 params with weight decay 0.03.
2025-08-21 08:14:46,486 - PixArt - INFO - Lr schedule: constant, num_warmup_steps:1000.
  0%|          | 0/19000 [00:00<?, ?it/s]  0%|          | 0/19000 [00:00<?, ?it/s]2025-08-21 08:14:58,151 - PixArt - INFO - Step/Epoch [1/1][1/19000]:total_eta: 1 day, 20:23:17, epoch_eta:22:11:38, time_all:0.421, time_data:0.114, lr:1.414e-08, s:(32, 32), loss:0.2729, grad_norm:0.5611, repa_loss:-0.0068
  0%|          | 1/19000 [00:08<44:11:06,  8.37s/it]2025-08-21 08:14:59,777 - PixArt - INFO - Running validation... 

  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 18.20it/s][A
 31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 19.08it/s][A
 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 19.69it/s][A
 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 19.57it/s][A
 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 20.00it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:00<00:00, 21.23it/s]

  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 19.96it/s][A
 31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 18.40it/s][A
 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 18.18it/s][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 18.68it/s][A
 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 18.35it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:00<00:00, 21.95it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:00<00:00, 20.20it/s]

  0%|          | 0/13 [00:00<?, ?it/s][A
 23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 20.33it/s][A
 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 18.91it/s][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 18.81it/s][A
 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 19.09it/s][A
 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 18.94it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:00<00:00, 20.50it/s]

  0%|          | 0/13 [00:00<?, ?it/s][A
 15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 19.27it/s][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 19.97it/s][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 19.93it/s][A
 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 20.07it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:00<00:00, 21.44it/s]

  0%|          | 0/13 [00:00<?, ?it/s][A
 23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 20.53it/s][A
 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 20.21it/s][A
 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 20.25it/s][A
 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 20.02it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:00<00:00, 21.66it/s]
  0%|          | 1/19000 [00:22<120:48:35, 22.89s/it]  0%|          | 2/19000 [00:24<67:23:01, 12.77s/it]  0%|          | 2/19000 [00:24<54:01:34, 10.24s/it]   0%|          | 3/19000 [00:25<39:35:04,  7.50s/it]  0%|          | 3/19000 [00:25<32:19:46,  6.13s/it]  0%|          | 4/19000 [00:26<26:30:41,  5.02s/it]  0%|          | 4/19000 [00:26<22:06:55,  4.19s/it]  0%|          | 5/19000 [00:27<19:16:31,  3.65s/it]  0%|          | 5/19000 [00:27<16:28:19,  3.12s/it]  0%|          | 6/19000 [00:29<14:54:22,  2.83s/it]  0%|          | 6/19000 [00:29<13:03:04,  2.47s/it]  0%|          | 7/19000 [00:30<12:10:23,  2.31s/it]  0%|          | 7/19000 [00:30<10:55:25,  2.07s/it]  0%|          | 8/19000 [00:31<10:21:14,  1.96s/it]  0%|          | 8/19000 [00:31<9:31:01,  1.80s/it]   0%|          | 9/19000 [00:32<9:09:29,  1.74s/it]   0%|          | 9/19000 [00:32<8:34:17,  1.62s/it]  0%|          | 10/19000 [00:34<8:19:17,  1.58s/it]  0%|          | 10/19000 [00:34<7:54:53,  1.50s/it]  0%|          | 11/19000 [00:35<7:45:21,  1.47s/it]  0%|          | 11/19000 [00:35<7:28:27,  1.42s/it]  0%|          | 12/19000 [00:36<7:22:03,  1.40s/it]  0%|          | 12/19000 [00:36<7:10:01,  1.36s/it]  0%|          | 13/19000 [00:37<7:05:30,  1.34s/it]  0%|          | 13/19000 [00:37<6:57:11,  1.32s/it]  0%|          | 14/19000 [00:38<6:54:01,  1.31s/it]  0%|          | 14/19000 [00:39<6:48:29,  1.29s/it]  0%|          | 15/19000 [00:40<7:49:29,  1.48s/it]  0%|          | 15/19000 [00:40<7:45:18,  1.47s/it]  0%|          | 16/19000 [00:42<7:25:24,  1.41s/it]  0%|          | 16/19000 [00:42<7:22:36,  1.40s/it]  0%|          | 17/19000 [00:43<7:08:36,  1.35s/it]  0%|          | 17/19000 [00:43<7:06:59,  1.35s/it]  0%|          | 18/19000 [00:44<6:57:29,  1.32s/it]  0%|          | 18/19000 [00:44<6:56:01,  1.31s/it]  0%|          | 19/19000 [00:45<6:48:41,  1.29s/it]  0%|          | 19/19000 [00:45<6:47:32,  1.29s/it]2025-08-21 08:15:36,788 - PixArt - INFO - Step/Epoch [20/1][20/19000]:total_eta: 23:38:05, epoch_eta:11:48:41, time_all:1.932, time_data:0.729, lr:2.828e-07, s:(32, 32), loss:0.2587, grad_norm:0.6726, repa_loss:-0.0271
  0%|          | 20/19000 [00:47<6:43:06,  1.27s/it]  0%|          | 20/19000 [00:47<6:42:38,  1.27s/it]  0%|          | 21/19000 [00:48<6:39:18,  1.26s/it]  0%|          | 21/19000 [00:48<6:38:47,  1.26s/it]  0%|          | 22/19000 [00:49<6:36:48,  1.25s/it]  0%|          | 22/19000 [00:49<6:36:20,  1.25s/it]  0%|          | 23/19000 [00:50<6:33:55,  1.25s/it]  0%|          | 23/19000 [00:50<6:33:56,  1.25s/it]  0%|          | 24/19000 [00:51<6:32:59,  1.24s/it]  0%|          | 24/19000 [00:51<6:32:43,  1.24s/it]  0%|          | 25/19000 [00:53<6:31:42,  1.24s/it]  0%|          | 25/19000 [00:53<6:31:29,  1.24s/it]  0%|          | 26/19000 [00:54<6:30:44,  1.24s/it]  0%|          | 26/19000 [00:54<6:30:58,  1.24s/it]  0%|          | 27/19000 [00:55<6:30:41,  1.24s/it]  0%|          | 27/19000 [00:55<6:30:34,  1.24s/it]  0%|          | 28/19000 [00:56<6:30:35,  1.24s/it]  0%|          | 28/19000 [00:56<6:30:22,  1.23s/it]  0%|          | 29/19000 [00:58<6:29:48,  1.23s/it]  0%|          | 29/19000 [00:58<6:29:48,  1.23s/it]  0%|          | 30/19000 [00:59<6:30:28,  1.24s/it]  0%|          | 30/19000 [00:59<6:30:28,  1.24s/it]  0%|          | 31/19000 [01:00<6:30:37,  1.24s/it]  0%|          | 31/19000 [01:00<6:30:39,  1.24s/it]  0%|          | 32/19000 [01:01<6:29:58,  1.23s/it]  0%|          | 32/19000 [01:01<6:29:57,  1.23s/it]  0%|          | 33/19000 [01:03<6:30:03,  1.23s/it]  0%|          | 33/19000 [01:03<6:30:11,  1.23s/it]  0%|          | 34/19000 [01:05<7:58:26,  1.51s/it]  0%|          | 34/19000 [01:05<7:58:15,  1.51s/it]  0%|          | 35/19000 [01:06<7:31:49,  1.43s/it]  0%|          | 35/19000 [01:06<7:31:41,  1.43s/it]  0%|          | 36/19000 [01:07<7:12:56,  1.37s/it]  0%|          | 36/19000 [01:07<7:13:52,  1.37s/it]  0%|          | 37/19000 [01:08<7:01:03,  1.33s/it]  0%|          | 37/19000 [01:08<7:00:42,  1.33s/it]  0%|          | 38/19000 [01:10<6:51:30,  1.30s/it]  0%|          | 38/19000 [01:10<6:51:22,  1.30s/it]  0%|          | 39/19000 [01:11<6:45:05,  1.28s/it]  0%|          | 39/19000 [01:11<6:45:01,  1.28s/it]2025-08-21 08:16:02,390 - PixArt - INFO - Step/Epoch [40/1][40/19000]:total_eta: 18:41:00, epoch_eta:9:19:55, time_all:1.280, time_data:0.005, lr:5.657e-07, s:(32, 32), loss:0.2090, grad_norm:0.6926, repa_loss:-0.1587
  0%|          | 40/19000 [01:12<6:40:35,  1.27s/it]  0%|          | 40/19000 [01:12<6:40:32,  1.27s/it]  0%|          | 41/19000 [01:13<6:38:12,  1.26s/it]  0%|          | 41/19000 [01:13<6:38:12,  1.26s/it]  0%|          | 42/19000 [01:15<6:36:29,  1.25s/it]  0%|          | 42/19000 [01:15<6:36:21,  1.25s/it]  0%|          | 43/19000 [01:16<6:39:42,  1.27s/it]  0%|          | 43/19000 [01:16<6:39:36,  1.26s/it]  0%|          | 44/19000 [01:17<6:38:03,  1.26s/it]  0%|          | 44/19000 [01:17<6:38:05,  1.26s/it]  0%|          | 45/19000 [01:18<6:36:54,  1.26s/it]  0%|          | 45/19000 [01:18<6:36:51,  1.26s/it]  0%|          | 46/19000 [01:20<6:35:54,  1.25s/it]  0%|          | 46/19000 [01:20<6:35:58,  1.25s/it]  0%|          | 47/19000 [01:21<6:34:06,  1.25s/it]  0%|          | 47/19000 [01:21<6:34:09,  1.25s/it]  0%|          | 48/19000 [01:22<6:33:37,  1.25s/it]  0%|          | 48/19000 [01:22<6:33:33,  1.25s/it]  0%|          | 49/19000 [01:23<6:32:31,  1.24s/it]  0%|          | 49/19000 [01:23<6:32:23,  1.24s/it]  0%|          | 50/19000 [01:25<6:32:25,  1.24s/it]  0%|          | 50/19000 [01:25<6:32:30,  1.24s/it]  0%|          | 51/19000 [01:26<6:33:18,  1.25s/it]  0%|          | 51/19000 [01:26<6:33:25,  1.25s/it]  0%|          | 52/19000 [01:27<6:32:04,  1.24s/it]  0%|          | 52/19000 [01:27<6:31:54,  1.24s/it]  0%|          | 53/19000 [01:28<6:31:20,  1.24s/it]  0%|          | 53/19000 [01:28<6:31:16,  1.24s/it]  0%|          | 54/19000 [01:30<6:31:30,  1.24s/it]  0%|          | 54/19000 [01:30<6:32:07,  1.24s/it]  0%|          | 55/19000 [01:31<6:31:49,  1.24s/it]  0%|          | 55/19000 [01:31<6:31:39,  1.24s/it]  0%|          | 56/19000 [01:32<6:48:27,  1.29s/it]  0%|          | 56/19000 [01:32<6:48:27,  1.29s/it]  0%|          | 57/19000 [01:33<6:43:41,  1.28s/it]  0%|          | 57/19000 [01:33<6:43:36,  1.28s/it]  0%|          | 58/19000 [01:35<6:40:04,  1.27s/it]  0%|          | 58/19000 [01:35<6:39:58,  1.27s/it]  0%|          | 59/19000 [01:36<6:37:25,  1.26s/it]  0%|          | 59/19000 [01:36<6:37:35,  1.26s/it]2025-08-21 08:16:27,451 - PixArt - INFO - Step/Epoch [60/1][60/19000]:total_eta: 16:52:51, epoch_eta:8:25:38, time_all:1.253, time_data:0.005, lr:8.485e-07, s:(32, 32), loss:0.1251, grad_norm:0.6196, repa_loss:-0.2967
  0%|          | 60/19000 [01:37<6:36:19,  1.26s/it]  0%|          | 60/19000 [01:37<6:36:13,  1.26s/it]  0%|          | 61/19000 [01:38<6:35:10,  1.25s/it]  0%|          | 61/19000 [01:38<6:34:56,  1.25s/it]  0%|          | 62/19000 [01:40<6:33:58,  1.25s/it]  0%|          | 62/19000 [01:40<6:34:05,  1.25s/it]  0%|          | 63/19000 [01:41<6:33:00,  1.25s/it]  0%|          | 63/19000 [01:41<6:33:05,  1.25s/it]  0%|          | 64/19000 [01:42<6:32:06,  1.24s/it]  0%|          | 64/19000 [01:42<6:32:05,  1.24s/it]  0%|          | 65/19000 [01:43<6:31:36,  1.24s/it]  0%|          | 65/19000 [01:43<6:31:40,  1.24s/it]  0%|          | 66/19000 [01:45<6:30:30,  1.24s/it]  0%|          | 66/19000 [01:45<6:30:50,  1.24s/it]  0%|          | 67/19000 [01:46<6:30:37,  1.24s/it]  0%|          | 67/19000 [01:46<6:30:27,  1.24s/it]  0%|          | 68/19000 [01:47<6:30:51,  1.24s/it]  0%|          | 68/19000 [01:47<6:30:46,  1.24s/it]  0%|          | 69/19000 [01:48<6:31:15,  1.24s/it]  0%|          | 69/19000 [01:48<6:31:48,  1.24s/it]  0%|          | 70/19000 [01:50<6:32:45,  1.24s/it]  0%|          | 70/19000 [01:50<6:32:26,  1.24s/it]  0%|          | 71/19000 [01:51<6:31:38,  1.24s/it]  0%|          | 71/19000 [01:51<6:31:20,  1.24s/it]  0%|          | 72/19000 [01:52<6:31:24,  1.24s/it]  0%|          | 72/19000 [01:52<6:31:22,  1.24s/it]  0%|          | 73/19000 [01:53<6:32:25,  1.24s/it]  0%|          | 73/19000 [01:53<6:32:18,  1.24s/it]  0%|          | 74/19000 [01:55<6:32:17,  1.24s/it]  0%|          | 74/19000 [01:55<6:32:13,  1.24s/it]  0%|          | 75/19000 [01:56<7:20:55,  1.40s/it]  0%|          | 75/19000 [01:56<7:21:00,  1.40s/it]  0%|          | 76/19000 [01:58<7:06:22,  1.35s/it]  0%|          | 76/19000 [01:58<7:06:40,  1.35s/it]  0%|          | 77/19000 [01:59<6:56:25,  1.32s/it]  0%|          | 77/19000 [01:59<6:56:14,  1.32s/it]  0%|          | 78/19000 [02:00<6:48:27,  1.30s/it]  0%|          | 78/19000 [02:00<6:48:25,  1.30s/it]  0%|          | 79/19000 [02:01<6:43:25,  1.28s/it]  0%|          | 79/19000 [02:01<6:43:29,  1.28s/it]2025-08-21 08:16:52,791 - PixArt - INFO - Step/Epoch [80/1][80/19000]:total_eta: 16:00:04, epoch_eta:7:59:02, time_all:1.267, time_data:0.005, lr:1.131e-06, s:(32, 32), loss:0.1020, grad_norm:0.7545, repa_loss:-0.3578
  0%|          | 80/19000 [02:03<6:39:54,  1.27s/it]  0%|          | 80/19000 [02:03<6:39:51,  1.27s/it]  0%|          | 81/19000 [02:04<6:37:53,  1.26s/it]  0%|          | 81/19000 [02:04<6:37:44,  1.26s/it]  0%|          | 82/19000 [02:05<6:35:52,  1.26s/it]  0%|          | 82/19000 [02:05<6:35:48,  1.26s/it]  0%|          | 83/19000 [02:06<6:35:04,  1.25s/it]  0%|          | 83/19000 [02:06<6:35:07,  1.25s/it]  0%|          | 84/19000 [02:07<6:33:33,  1.25s/it]  0%|          | 84/19000 [02:08<6:33:47,  1.25s/it]  0%|          | 85/19000 [02:09<6:33:31,  1.25s/it]  0%|          | 85/19000 [02:09<6:33:43,  1.25s/it]  0%|          | 86/19000 [02:10<6:33:41,  1.25s/it]  0%|          | 86/19000 [02:10<6:33:33,  1.25s/it]  0%|          | 87/19000 [02:11<6:32:56,  1.25s/it]  0%|          | 87/19000 [02:11<6:32:52,  1.25s/it]  0%|          | 88/19000 [02:12<6:32:44,  1.25s/it]  0%|          | 88/19000 [02:13<6:32:39,  1.25s/it]  0%|          | 89/19000 [02:14<6:32:31,  1.25s/it]  0%|          | 89/19000 [02:14<6:32:50,  1.25s/it]  0%|          | 90/19000 [02:15<6:32:38,  1.25s/it]  0%|          | 90/19000 [02:15<6:32:45,  1.25s/it]  0%|          | 91/19000 [02:16<6:32:35,  1.25s/it]  0%|          | 91/19000 [02:16<6:32:20,  1.24s/it]  0%|          | 92/19000 [02:17<6:34:04,  1.25s/it]  0%|          | 92/19000 [02:18<6:34:01,  1.25s/it]  0%|          | 93/19000 [02:19<6:32:39,  1.25s/it]  0%|          | 93/19000 [02:19<6:32:34,  1.25s/it]  0%|          | 94/19000 [02:20<6:32:26,  1.25s/it]  0%|          | 94/19000 [02:20<6:32:14,  1.24s/it]  0%|          | 95/19000 [02:21<6:32:02,  1.24s/it]  0%|          | 95/19000 [02:21<6:31:55,  1.24s/it]  1%|          | 96/19000 [02:22<6:32:42,  1.25s/it]  1%|          | 96/19000 [02:22<6:33:02,  1.25s/it]  1%|          | 97/19000 [02:24<6:32:03,  1.24s/it]  1%|          | 97/19000 [02:24<6:32:23,  1.25s/it]  1%|          | 98/19000 [02:25<6:32:10,  1.24s/it]  1%|          | 98/19000 [02:25<6:32:03,  1.24s/it]  1%|          | 99/19000 [02:26<6:31:59,  1.24s/it]  1%|          | 99/19000 [02:26<6:31:48,  1.24s/it]2025-08-21 08:17:17,694 - PixArt - INFO - Step/Epoch [100/1][100/19000]:total_eta: 15:25:17, epoch_eta:7:41:26, time_all:1.245, time_data:0.005, lr:1.414e-06, s:(32, 32), loss:0.0790, grad_norm:0.4797, repa_loss:-0.3818
  1%|          | 100/19000 [02:27<6:32:07,  1.24s/it]  1%|          | 100/19000 [02:27<6:32:32,  1.25s/it]  1%|          | 101/19000 [02:29<6:32:17,  1.25s/it]  1%|          | 101/19000 [02:29<6:32:22,  1.25s/it]  1%|          | 102/19000 [02:30<6:32:20,  1.25s/it]  1%|          | 102/19000 [02:30<6:32:00,  1.24s/it]  1%|          | 103/19000 [02:31<6:32:15,  1.25s/it]  1%|          | 103/19000 [02:31<6:31:59,  1.24s/it]  1%|          | 104/19000 [02:32<6:32:08,  1.25s/it]  1%|          | 104/19000 [02:32<6:31:56,  1.24s/it]  1%|          | 105/19000 [02:34<6:32:32,  1.25s/it]  1%|          | 105/19000 [02:34<6:32:28,  1.25s/it]  1%|          | 106/19000 [02:35<6:32:19,  1.25s/it]  1%|          | 106/19000 [02:35<6:32:32,  1.25s/it]  1%|          | 107/19000 [02:36<6:31:18,  1.24s/it]  1%|          | 107/19000 [02:36<6:31:21,  1.24s/it]  1%|          | 108/19000 [02:37<6:32:21,  1.25s/it]  1%|          | 108/19000 [02:37<6:32:18,  1.25s/it]  1%|          | 109/19000 [02:39<6:32:23,  1.25s/it]  1%|          | 109/19000 [02:39<6:32:19,  1.25s/it]  1%|          | 110/19000 [02:40<6:32:01,  1.25s/it]  1%|          | 110/19000 [02:40<6:32:58,  1.25s/it]  1%|          | 111/19000 [02:41<6:33:05,  1.25s/it]  1%|          | 111/19000 [02:41<6:32:51,  1.25s/it]  1%|          | 112/19000 [02:42<6:33:33,  1.25s/it]  1%|          | 112/19000 [02:42<6:33:22,  1.25s/it]  1%|          | 113/19000 [02:44<6:32:43,  1.25s/it]  1%|          | 113/19000 [02:44<6:32:37,  1.25s/it]  1%|          | 114/19000 [02:45<6:32:37,  1.25s/it]  1%|          | 114/19000 [02:45<6:32:29,  1.25s/it]  1%|          | 115/19000 [02:46<6:32:42,  1.25s/it]  1%|          | 115/19000 [02:46<6:32:39,  1.25s/it]  1%|          | 116/19000 [02:47<6:32:03,  1.25s/it]  1%|          | 116/19000 [02:47<6:32:01,  1.25s/it]  1%|          | 117/19000 [02:49<6:32:00,  1.25s/it]  1%|          | 117/19000 [02:49<6:31:54,  1.25s/it]  1%|          | 118/19000 [02:50<7:07:19,  1.36s/it]  1%|          | 118/19000 [02:50<7:07:18,  1.36s/it]  1%|          | 119/19000 [02:51<6:57:09,  1.33s/it]  1%|          | 119/19000 [02:52<6:58:03,  1.33s/it]